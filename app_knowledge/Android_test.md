# Android 测试

>##  Android测试
>### 功能测试
>* 对比：
>   * web 测试与app测试区别
>   * 相同点：
>     * 1
>   * 不同点：
>     * 系统结构不同.app 是c/s ，web 是B/S,app的服务端修改，所有客户端核心版本都要测试，web只需要更新服务端
>     * 性能方面,app还需要监控电量，流量,gpu过度绘制
>     * 兼容性方面，app需要测试系统的不同（android和ios），手机厂商的不同，系统版本的不同
>* 思考：
>   * 怎么判断用什么测试设计方法
>      *  如果测试单个功能点（单个控件，不涉及业务流程）--->等价类，边界值
>      *  涉及业务流程（包含不同功能点之间的关联）--->场景分析（流程图法）
>   * 如何减少写用例和读用例的时间
>      *  和控件本身相关，但是和业务逻辑关系不大，可以形成规范，不用写在用例当中
>   * 如何有效防止漏测？
>* 通用测试思路
>   * 单个功能点本身
>      *  涉及 有数据可行与不可行的选择等价类划分法
>      *  涉及到具体数值的，可以用边界值
				>*  边界值可以在SRS中获取，没有定义的，靠常识判断最小值，最大值不能超过数据库定义
>   * 功能交互测试
>      *  和其他模块的交互
>      *  与其他app或其他系统的交互
>   * 特殊测试
>      *  防止重复点击机制
>      *  提交成功以后，看数据落库是否正确
>      *  浏览器回退功能，看是否存在安全问题
>      *  退出登陆后，访问登录状态才能访问的页面，看是否存在安全问题
>   * 用户场景测试
>      *  本身场景
					
>#### * 环境准备：
>* 修改hosts,链接的重定向，来连接一个可以连接的服务器
>* 测试方法：
>   * fiddler 中链接状态
>      *  黄色 需要登录
>      *  灰色 代表图片
>      *  红色 状态错误
>      *  蓝色 html
>      *  紫色 css
>      *  绿色 scrpt
>* 过滤器的使用（Filters）
>  * 仅主机地址
>* fiddler 包数据查看（探测器使用）
>* 通过请求数据可以查看APP的请求是否正确
>  * 错误发生在前端
>* 通过响应数据可以查看服务器的响应数据是否正确
>  * 如果响应数据正确，则错误发生在前端
>  * 如果响应数据有误，则错误发生在后端
>* 如何判断：
>  * 数据库中的具体数据
>  * 接口文档
>* 自动回复器（Autoresponder）

### 性能测试
>* 环境准备
>   * 设置fiddler 代理
>   * 手机或者模拟器设置代理，主机地址设置为电脑地址，端口设置为fiddler的端口8888
>      *  通过adb设置：
>          *     adb shell settings put global http_proxy 127.0.0.1:8888
>* 测试内容
>   * 1、对服务端进行并发测试
>      *  常见性能指标:
				>*  响应时间
				>*  并发量
				>*  吞吐量
				>*  cpu，内存占用
>   * 2、客户端app进行性能测试
>      *  常见性能指标
				>*  时间
>         *  冷启动时间
                             – 没有相关常驻内存内容，即杀掉进程以后启动APP
                             – 1、通过日志查看
                             – 2、通过app（日志管理）查看，使用displayed过滤
>         *  页面切换时间
                             – 通过app查看，使用displayed过滤
				>*  存储
>         *  占用外部存储空间
                             – adb连接后，adb shell 进入手机目录
                             – 进入/data/app 目录，查看包占用空间 
                             – 进入/data/data 目录，查看包占用空间 
>         *  占用内存空间
                             – adb shell dumpsys meminfo | find "包名"
				>*  gpu占用
>         *  gpu绘制的作用：还原色彩
                             – gpu 绘制的次数越多，对色彩的还原度越好，同时会占用更多的GPU资源，导致页面加载变慢，影响客户体验
>         *  打开开发者选项中的调试GPU过度绘制-->显示过度绘制区域
                             – 颜色：绿色、蓝色和红色
                                 w 红色就说明存在过度绘制，红色越深，说明过度绘制越厉害。
                             – 验收标准：
                                 w 不出现红色区域
                                 w 粉色区域总面积不超过屏幕的 1/3
>         *  显示流畅性（不要出现卡顿）
				>*  资源消耗
>         *  流量
>         *  电量
>         *  cpu,内存占用
>         *  Solopi APP工具
							
### 稳定性测试
>* monkey工具
>   * 随机模拟：
>      *  adb shell monkey -p 包名 --throttle 时间间隔 -s 种子值 -v -v -v 操作次数
				>*  会模拟人的操作，随机做各种行为
>      *  获取当前应用包名
				>*  adb shell dumpsys window | findstr "mCurrentFocus"
>   * 指定动作：
>      * adb shell monkey -p com.tal.kaoyan --pct-touch 100 --throttle 500 -s 888 -v -v -v 100
				>*  -p，指明要测试的app，如果不写-p参数是指针对手机整机来进行测试。
				>*  --throttle，指明每次操作的间隔，一般设置为500，对应500ms（半秒），模拟人的正常速度。如果设置为更小的值，模拟人的快速点击，属于性能测试中压力测试。
				>*  -s，通过一个数字来生成随机测试的操作序列（点击->滑屏->点击->点击->滑屏）。
				>*  -v，用于设置monkey日志的详细程度，3个-v表示最详细。
				>*  可以添加多个动作，动作后带比例，总比例为100
				>*  最后跟动作次数
>      *  <img src="/app_knowledge/adb_monkey.png">
>      * 输出日志到文件
>          *  例如:
				>*  adb shell monkey -p com.taobao.taobao --throttle 1000 -v 50 >C:\Users\Desktop\monkeylog\log1
>      * 工作中monkey如何使用
>          *  1、确定测试对象（包名）
>          *  2、确定要使用的操作
>          *  3、确定要操作的次数
>          *  4、确定时间间隔
>          *  5、执行monkey命令之前，我们可以打开性能检测工具，在执行完monkey命令可以查看相关的性能参数
>          *  6、同时用日志查看工具，查看相关的日志，如果有E或者F的，可以告知开发
					
### 兼容性测试
>* web端兼容性测试
>   * 浏览器种类：
>      *  chrome,firefox,edge,opera,safari 内核不同
>   * 浏览器版本：使用最新的版本
>   * 操作系统是浏览器厂商需要考虑的
>   * 上线规则：
>      *  第一个版本至少支持两个主流浏览器就行
>      *  统计使用浏览器类型
>      *  最终做到适配95%的用户就行
>   * 屏幕的分辨率
>      *  针对不同的物理分辨率，设置不同的逻辑分辨率就行，分别检查页面显示是否正常
>* APP端的兼容性测试
>   * 1、手机的操作系统
>      *  覆盖主流操作系统
>      *  版本：横向版本，不同厂商版本
>      *  初期覆盖主流版本，使用代码统计使用app的操作系统及版本，针对其中的主要系统和版本做兼容性测试，最终能适配95%用户就行了
>   * 2、机型
>      *  屏幕类型
				>*  全屏，非全面屏
>      *  屏幕尺寸
				>*  5，5.5，6，7，8
>      *  屏幕像素密度
>* APP兼容性测试方式
>   * 1、自购或者租借主流手机
>      *  使用adb实现简单的兼容性测试
				>*  主要使用adb am , adb pm ，adb shell input命令
>         *  adb shell am start 包名/activity名 （包名和activity名都要写）
                             – 启动应用
>         *  adb shell am force-stop 包名
                             – 停止应用
>         *  adb shell pm clear 包名
                             – 清理应用文件
>         *  adb uninstall 包名
                             – 卸载应用
>         *  adb shell sleep num 
                             – 强制等待一段时间
>         *  adb  shell input text 内容
                             – 在控件中输入信息
>         *  adb shell 
				>*  windows:将命令脚本保存为批处理文件.bat，直接执行
				>*  linux:保存为.sh文件
>   * 2、外包
>   * 3、利用云测平台（推荐方法）
>      *  阿里云，腾讯云，华为云
>      *  阿里云
				>*  使用介绍:
		
### 网络测试
>* 关注APP在不同网络情况下的表现，比如3G,4G,5G，wifi，弱网，无网等情况
>* 弱网：
>   * 使用fiddler -->模拟调制选调器-->弱网
>* 无网：
>   * 打开飞行模式

### 其他测试
>* 1、安装与卸载
>   * 安装包的资源文件检查，病毒检查
>   * 不同形式安装，应用商店，网页下载安装，adb命令安装，直接拖动
>   * 启动，运行，卸载等相关检查
>   * 升级，降级
>* 2、用户体验测试
>   * 界面是否美观，颜色布局是否合理（参照UI设计图）
>   * 操作的便捷性，步骤是否简洁，一般三次操作可以达到你的目的
>   * 检查布局边界，开发者模式--->显示页面布局
>      *  原则：无效点击区域尽量少
>* 3、异常情况测试
>   * 网络的端开和恢复，飞行模式
>   * 突然断电。条件允许的情况下拔电池
>   * APP闪退，使用kill-9 进程号 ，模拟
>      *  查找进程： adb shell ps |find "com.tal.kaoyan"
>      *  kill-9 进程号
>   * APP收到异常信息
>      *  使用fiddler模拟响应
>   * 面试技巧：
>      *  APP与web端不同点
>         * 从功能，性能，兼容性，网络，其他5个方面比较不同点，重点描述App测试
   
